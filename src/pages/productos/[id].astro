---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import type { Product } from "@/data/products";
import { products, getProductById } from "@/data/products";

import Breadcrumb from "@/components/Breadcrumb.astro";

export async function getStaticPaths() {
  return products.map((p) => ({
    params: { id: p.id },
    props: { product: p },
  }));
}

// si prefieres obtener el producto usando Astro.params en runtime,
// puedes acceder a Astro.params (más abajo) — aquí usamos props si están
export const prerender = true;

const product = Astro.props.product ?? getProductById(Astro.params.id);
---

<Layout>
  <section class="max-w-6xl mx-auto px-4 py-12 text-white">
    <Breadcrumb product={product.title} />

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <!-- Imagen del producto -->
      <div
        class="flex justify-center items-center shadow-lg w-full rounded-2xl border border-gray-200 max-h-[450px] overflow-hidden"
      >
        <img
          src={product.image}
          alt={product.title}
          class="aspect-square object-contain p-8 w-full h-full hover:scale-125 transition-transform duration-500"
        />
      </div>

      <!-- Información -->
      <div
        class="bg-gradient-to-br from-blue-900 to-sky-700 px-4 rounded-lg flex flex-col justify-center"
      >
        {
          product.brand && (
            <p class="text-blue-400 font-semibold pt-12">{product.brand}</p>
          )
        }
        <h1 class="text-3xl md:text-4xl font-bold pb-8">{product.title}</h1>

        {
          product.price && (
            <p class="text-xl font-bold text-green-400">{product.price}</p>
          )
        }

        {
          product.description && (
            <p class="text-gray-300 leading-relaxed">{product.description}</p>
          )
        }

        {
          product.features && (
            <ul class="space-y-2 flex flex-col flex-1 justify-center">
              {product.features.map((f) => (
                <li class="flex items-center gap-2">
                  <Icon name="arrowLeft" size={18} class="text-green-400" />
                  <span>{f}</span>
                </li>
              ))}
            </ul>
          )
        }

        <div class="flex flex-wrap gap-4 py-8">
          <a
            href="/contacto"
            class="bg-green-600 hover:bg-green-500 px-6 py-3 rounded-lg font-bold transition-colors"
          >
            Solicitar información
          </a>
          <a
            href="/productos"
            class="border border-white/30 px-6 py-3 rounded-lg hover:bg-white/10 transition-colors"
          >
            Volver a productos
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>
